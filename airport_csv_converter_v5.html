
<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Airport CSV to JS Converter v5 (Auto Timezone Lookup)</title>
  <style>
    body { font-family: monospace; padding: 20px; }
    textarea, .output { width: 100%; height: 180px; margin-top: 10px; font-family: monospace; white-space: pre; }
    .output { background: #f0f0f0; border: 1px solid #ccc; padding: 8px; overflow-x: auto; }
  </style>
  <!-- Include tz-lookup library -->
  <script src="https://unpkg.com/tz-lookup/tz.js"></script>
</head>
<body>
  <h2>‚úàÔ∏è Airport CSV ‚ûú JS Converter (v5 ‚Äì Auto Timezone Lookup)</h2>
  <p>Ë´ãË≤º‰∏ä‰Ω†ÁöÑ CSV Ë≥áÊñôÔºàÊ†ºÂºèÔºöident,name,latitude_deg,longitude_degÔºâÔºö</p>
  <textarea id="csvInput">ident,name,latitude_deg,longitude_deg
KSFO,San Francisco Intl,37.6188056,-122.3754167
KLAX,Los Angeles Intl,33.942536,-118.408075
RJTT,Tokyo Haneda,35.552258,139.779694
OMDB,Dubai Intl,25.2532,55.3657</textarea>
  <br>
  <button onclick="convert()">üöÄ ËΩâÊèõ</button>

  <h3>AIRPORTS Áâ©‰ª∂Ôºö</h3>
  <div class="output" id="airportsOut"></div>

  <h3>ICAO_TIMEZONESÔºö</h3>
  <div class="output" id="timezonesOut"></div>

  <script>
    function toJSString(str) {
      return str.replace(/"/g, '\"');
    }

    function convert() {
      const csv = document.getElementById("csvInput").value.trim();
      const lines = csv.split(/\r?\n/);
      const [header, ...rows] = lines;
      const output = [];
      const tzOut = [];

      output.push("const AIRPORTS = {");
      tzOut.push("const ICAO_TIMEZONES = {");

      rows.forEach(row => {
        const parts = row.split(",");
        if (parts.length < 4) return;
        const [icao, name, lat, lon] = parts.map(x => x.trim());
        if (!icao || isNaN(parseFloat(lat)) || isNaN(parseFloat(lon))) return;

        output.push(`  "${icao}": { name: "${toJSString(name)}", lat: ${lat}, lon: ${lon} },`);

        let tz = "";
        try {
          tz = tzlookup(parseFloat(lat), parseFloat(lon));
        } catch (e) {
          tz = "";
        }

        tzOut.push(`  "${icao}": "${tz}",`);
      });

      output.push("};");
      tzOut.push("};");

      document.getElementById("airportsOut").textContent = output.join("\n");
      document.getElementById("timezonesOut").textContent = tzOut.join("\n");
    }
  </script>
</body>
</html>
